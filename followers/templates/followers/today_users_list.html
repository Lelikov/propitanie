{% extends 'followers/main.html' %}
{% block content %}
<div class="d-flex flex-column align-items-center col-12">
    <div class="card-deck h-100">
        <div class="card text-center">
            <div class="card-img-top">
                Заработок в месяц
            </div>
            <div class="card-body">
                <h5 class="card-title text-success">{{earning}}₽</h5>
            </div>
        </div>
        <div class="card text-center">
            <div class="card-img-top">
                Всего пользователей
            </div>
            <div class="card-body">
                <h5 class="card-title">{{number_of_paid_users}}</h5>
            </div>
        </div>
    </div>
    {% if today_users %}
    <div><h4 class="mb-3 ">Новые пользователи за сегодня</h4></div>
    <table class="table table-striped col-lg-6 col-md-12 col-sm-12 col-xs-12">
        <thead>
        <tr>
            <th scope="col">Имя</th>
            <th scope="col">Подписан до</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        {%for user in today_users%}
        <tr>
            {% if user.status.name == "Not added" %}
            <td>
                <a href="{% url 'UserEdit' pk=user.pk %}" class="text-danger">{{ user.name }}</a>
            </td>
            <td class="text-danger">
                {{ user.subscribe_until|date:'d E Y' }}
            </td>
            {% elif user.status.name == "Sent request" %}
            <td>
                <a href="{% url 'UserEdit' pk=user.pk %}" class="text-warning">{{ user.name }}</a>
            </td>
            <td class="text-warning">
                {{ user.subscribe_until|date:'d E Y' }}
            </td>
            {% else %}
            <td>
                <a href="{% url 'UserEdit' pk=user.pk %}" class="text-success">{{ user.name }}</a>
            </td>
            <td class="text-success">
                {{ user.subscribe_until|date:'d E Y' }}
            </td>
            {% endif %}
            <td class="d-flex justify-content-end">
                <div class="d-flex">
                    <form action="{% url 'ChangeUserStatus' %}" method="post">
                        <input type="hidden" value="{{ user.name }}" name="name">
                        <input type="hidden" value="Sent request" name="status">
                        <button type="submit" class="btn btn-lg btn-warning mr-5">
                            Запрос
                        </button>
                    </form>
                    <form action="{% url 'ChangeUserStatus' %}" method="post">
                        <input type="hidden" value="{{ user.name }}" name="name">
                        <input type="hidden" value="Added" name="status">
                        <button type="submit" class="btn btn-lg btn-success">
                            Подписан
                        </button>
                    </form>
                </div>
            </td>
        </tr>
        {%endfor%}
        </tbody>
    </table>
    {% else %}
    <div>
        <h4 class="mb-3 mt-3">Сегодня новых пользователей нет</h4>
        <h4 class="text-center">&#128546;</h4>
    </div>
    {% endif %}
</div>
{% endblock %}